<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paletify | Generador Dinámico con Flexbox</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700&display=swap');

        body {
            font-family: 'Outfit', sans-serif;
            background-color: #f1f5f9;
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Estructura Principal con Flexbox */
        #palette-container {
            display: flex;
            flex-direction: row; /* Colores uno al lado del otro en escritorio */
            flex-grow: 1;        /* Ocupa todo el espacio restante */
            gap: 1rem;
            padding: 1.5rem;
        }

        /* Responsive: Cambio a columna en móviles */
        @media (max-width: 768px) {
            #palette-container {
                flex-direction: column;
                height: auto;
            }
            .color-column {
                height: 150px !important;
            }
        }

        .color-column {
            flex: 1 1 0; /* Flexbox: grow, shrink, basis */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 1.5rem;
            position: relative;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }

        .color-column:hover {
            flex: 1.5 1 0; /* Efecto de expansión Flexbox al pasar el mouse */
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.15);
        }

        .locked {
            box-shadow: inset 0 0 0 6px rgba(255, 255, 255, 0.3);
        }

        .copy-btn {
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .color-column:hover .copy-btn {
            opacity: 1;
            transform: translateY(0);
        }

        /* Clase para animar el cambio de color */
        .color-swatch-animate {
            transition: background-color 0.5s ease;
        }
    </style>
</head>
<body class="color-bg-main">

    <!-- Header con Flexbox -->
    <header class="flex flex-row justify-between items-center p-6 bg-white border-b border-slate-200">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-emerald-500 rounded-xl shadow-inner"></div>
            <h1 class="text-2xl font-bold text-slate-800 tracking-tight">Paletify</h1>
        </div>
        <div class="flex items-center gap-4">
            <span class="hidden md:inline text-slate-400 text-sm">Usa [Espacio] para mezclar</span>
            <button onclick="generatePalette()" class="bg-slate-900 hover:bg-slate-800 text-white px-6 py-2.5 rounded-full font-semibold shadow-lg transition active:scale-95 flex items-center gap-2">
                <i class="fas fa-random"></i>
                <span>Nueva Paleta</span>
            </button>
        </div>
    </header>

    <!-- Contenedor Dinámico -->
    <main id="palette-container">
        <!-- Generado dinámicamente con JS -->
    </main>

    <!-- Footer / Barra de Herramientas -->
    <footer class="bg-white p-6 border-t border-slate-200 flex flex-col md:flex-row justify-between items-center gap-4">
        <div class="text-slate-500 text-sm">
            <i class="fas fa-info-circle mr-1"></i> Haz clic en el candado para fijar un color.
        </div>
        <div class="flex gap-2">
            <div id="palette-summary" class="flex -space-x-2">
                <!-- Miniatura de la paleta -->
            </div>
        </div>
    </footer>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-slate-800 text-white px-6 py-3 rounded-2xl shadow-2xl opacity-0 transition-all pointer-events-none z-50">
        Copiado al portapapeles
    </div>

    <script>
        let colors = [];
        const container = document.getElementById('palette-container');

        // Estado inicial
        function init() {
            for(let i = 0; i < 5; i++) {
                colors.push({
                    hex: getRandomHex(),
                    locked: false
                });
            }
            render();
        }

        function getRandomHex() {
            const hex = Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
            return '#' + hex.toUpperCase();
        }

        // Determinar color de texto según contraste
        function getContrast(hex) {
            const r = parseInt(hex.slice(1,3), 16);
            const g = parseInt(hex.slice(3,5), 16);
            const b = parseInt(hex.slice(5,7), 16);
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            return brightness > 125 ? '#0f172a' : '#ffffff';
        }

        function toggleLock(index, e) {
            e.stopPropagation();
            colors[index].locked = !colors[index].locked;
            render();
        }

        function copy(text) {
            navigator.clipboard.writeText(text);
            const toast = document.getElementById('toast');
            toast.innerText = `Copiado: ${text}`;
            toast.classList.replace('opacity-0', 'opacity-100');
            setTimeout(() => toast.classList.replace('opacity-100', 'opacity-0'), 2000);
        }

        function generatePalette() {
            colors = colors.map(c => c.locked ? c : { hex: getRandomHex(), locked: false });
            render();
        }

        function render() {
            container.innerHTML = '';
            const summary = document.getElementById('palette-summary');
            summary.innerHTML = '';

            colors.forEach((color, index) => {
                const textColor = getContrast(color.hex);
                
                // Crear columna Flex
                const col = document.createElement('div');
                col.className = `color-column color-swatch-animate ${color.locked ? 'locked' : ''}`;
                col.style.backgroundColor = color.hex;
                col.style.color = textColor;
                col.onclick = () => copy(color.hex);

                col.innerHTML = `
                    <button onclick="toggleLock(${index}, event)" class="absolute top-8 p-3 rounded-full hover:bg-black/10 transition">
                        <i class="fas ${color.locked ? 'fa-lock' : 'fa-lock-open'} text-lg"></i>
                    </button>
                    
                    <div class="flex flex-col items-center">
                        <span class="text-3xl font-bold tracking-wider mb-2 uppercase">${color.hex}</span>
                        <div class="copy-btn bg-white/20 backdrop-blur-sm px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-tighter">
                            Hacer clic para copiar
                        </div>
                    </div>

                    <div class="absolute bottom-8 opacity-40 font-mono text-xs">
                        ID: ${index + 1}
                    </div>
                `;
                
                container.appendChild(col);

                // Miniatura en el footer
                const dot = document.createElement('div');
                dot.className = 'w-6 h-6 rounded-full border-2 border-white';
                dot.style.backgroundColor = color.hex;
                summary.appendChild(dot);
            });
        }

        // Eventos
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                generatePalette();
            }
        });

        init();
    </script>
</body>
</html>